<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Newsletter Capture</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <!-- Ã‰cran de verrouillage (PIN) -->
    <div id="lockScreen" class="screen">
        <div class="logo">ğŸ“©</div>
        <h1>Newsletter Capture</h1>
        <p class="subtitle">AccÃ¨s rÃ©servÃ©</p>

        <div class="pin-container">
            <input type="password" id="pinInput" placeholder="Entrer le PIN" maxlength="6" autofocus>
            <button id="unlockBtn" class="btn btn-primary">DÃ©verrouiller</button>
        </div>

        <p id="pinError" class="error" style="display: none;">PIN incorrect</p>
    </div>

    <!-- Ã‰cran principal (aprÃ¨s dÃ©verrouillage) -->
    <div id="mainScreen" class="screen" style="display: none;">
        <div class="header">
            <div class="logo-small">ğŸ“©</div>
            <h2>Newsletter Capture</h2>
            <button id="settingsBtn" class="btn-icon" title="ParamÃ¨tres">âš™ï¸</button>
            <button id="lockBtn" class="btn-icon" title="Verrouiller">ğŸ”’</button>
        </div>

        <!-- Formulaire de capture -->
        <div class="capture-form">
            <div class="form-group">
                <label for="sourceInput">Source / Auteur</label>
                <input type="text" id="sourceInput" placeholder="Ex: Nina Ramen, Caroline Mignaux...">
            </div>

            <div class="form-group">
                <label for="subjectInput">Sujet de la newsletter</label>
                <input type="text" id="subjectInput" placeholder="Ex: 5 erreurs LinkedIn Ã  Ã©viter">
            </div>

            <div class="form-group">
                <label for="contentInput">Contenu (extrait automatiquement ou coller)</label>
                <textarea id="contentInput" rows="8" placeholder="Le contenu de la newsletter sera extrait automatiquement ou tu peux le coller ici..."></textarea>
            </div>

            <div class="form-group">
                <label for="urlInput">URL (optionnel)</label>
                <input type="text" id="urlInput" placeholder="https://...">
            </div>

            <div class="form-group">
                <label for="tagsInput">Tags (sÃ©parÃ©s par des virgules)</label>
                <input type="text" id="tagsInput" placeholder="linkedin, algorithme, hooks...">
            </div>

            <div class="actions">
                <button id="extractBtn" class="btn btn-secondary">ğŸ” Extraire de la page</button>
                <button id="captureBtn" class="btn btn-primary">ğŸ“¥ Capturer</button>
            </div>
        </div>

        <!-- Status -->
        <div id="status" class="status" style="display: none;"></div>

        <!-- Historique rÃ©cent -->
        <div class="history-section">
            <h3>Captures rÃ©centes</h3>
            <div id="historyList" class="history-list">
                <p class="empty">Aucune capture rÃ©cente</p>
            </div>
        </div>
    </div>

    <!-- Ã‰cran de configuration (premier lancement) -->
    <div id="setupScreen" class="screen" style="display: none;">
        <div class="logo">âš™ï¸</div>
        <h1>Configuration initiale</h1>
        <p class="subtitle">DÃ©finis ton PIN secret et connecte Supabase</p>

        <div class="setup-form">
            <div class="form-group">
                <label for="newPinInput">CrÃ©er un PIN (4-6 chiffres)</label>
                <input type="password" id="newPinInput" placeholder="Ex: 1234" maxlength="6">
            </div>

            <div class="form-group">
                <label for="confirmPinInput">Confirmer le PIN</label>
                <input type="password" id="confirmPinInput" placeholder="Confirmer..." maxlength="6">
            </div>

            <div class="form-group">
                <label for="supabaseUrlInput">URL Supabase</label>
                <input type="text" id="supabaseUrlInput" placeholder="https://xxx.supabase.co">
            </div>

            <div class="form-group">
                <label for="supabaseKeyInput">ClÃ© Anon Supabase</label>
                <input type="password" id="supabaseKeyInput" placeholder="eyJhbGciOiJ...">
            </div>

            <button id="saveSetupBtn" class="btn btn-primary">Sauvegarder</button>
        </div>

        <p id="setupError" class="error" style="display: none;"></p>
    </div>

    <!-- Ã‰cran ParamÃ¨tres (modification) -->
    <div id="settingsScreen" class="screen" style="display: none;">
        <div class="header">
            <button id="backBtn" class="btn-icon" title="Retour">â†</button>
            <h2>ParamÃ¨tres</h2>
        </div>

        <div class="setup-form">
            <div class="form-group">
                <label for="editSupabaseUrl">URL Supabase</label>
                <input type="text" id="editSupabaseUrl" placeholder="https://xxx.supabase.co">
            </div>

            <div class="form-group">
                <label for="editSupabaseKey">ClÃ© Anon Supabase</label>
                <input type="password" id="editSupabaseKey" placeholder="eyJhbGciOiJ...">
            </div>

            <button id="saveSettingsBtn" class="btn btn-primary">Sauvegarder</button>

            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1);">
                <button id="resetAllBtn" class="btn btn-secondary" style="width: 100%; background: rgba(255,71,87,0.2); border-color: rgba(255,71,87,0.4); color: #ff4757;">ğŸ—‘ï¸ Tout rÃ©initialiser</button>
            </div>
        </div>

        <p id="settingsError" class="error" style="display: none;"></p>
        <p id="settingsSuccess" class="success" style="display: none;"></p>
    </div>

    <script src="popup.js"></script>
</body>
</html>
